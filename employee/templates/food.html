{% extends 'layout.html' %}
{% block body %}

<style>
    @media print {
    body * {
      visibility: hidden;
    }

    .print-only-table, .print-only-table * {
      visibility: visible;
    }

    .print-only-table {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
    }
  }
</style>


<!-- Add Lunch Enrollment Modal -->
<div class="modal fade" id="addLunchModal" tabindex="-1" aria-labelledby="addLunchModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form method="POST" action="{% url 'add_lunch_enrollment' %}">
          {% csrf_token %}
          <div class="modal-header">
            <h5 class="modal-title" id="addLunchModalLabel">Add Lunch Enrollment</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          
          <div class="modal-body">
            <div class="mb-3">
              <label for="employee" class="form-label">Select Employee</label>
              <select class="form-select" id="employee" name="employee_id" required>
                <option value="" selected disabled>-- Select Employee --</option>
                {% for emp in employees %}
                <option value="{{ emp.id }}">{{ emp.user.get_full_name }} ({{ emp.department.name }})</option>
                {% endfor %}
              </select>
            </div>
          </div>
          
          <div class="modal-footer">
            <button type="submit" class="btn btn-dark">Enroll</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  

  <div class="d-flex" style="margin-top: 80px;">


    <div class="bg-light text-dark p-3" style="min-width: 250px; min-height: 100vh;">
        <h5 class="text-center mb-4">Resources and Benefits</h5>
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewAwards' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewAwards">üèÜ Awards and Incentives</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'healthInsurance' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/healthInsurance">üíä Health Insurance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewCars' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewCars">üöó Car</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewMobile' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewMobile">üì± Mobile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewAccomodation' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewAccomodation">üè† Accommodation</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewTravelAllowance' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewTravelAllowance">‚úàÔ∏è Travel Allowance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewFoodAndMeals' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewFoodAndMeals">üç± Food and Meals</a>
          </li>
          
        </ul>
      </div>


<div style="width: 1200px;">
    <div class="d-flex mb-4 align-items-center">
        <h4 class="mb-0">Lunch Enrollment</h4>

        <form method="GET" class="d-flex ms-auto me-3" style="gap: 10px;">
            <input type="date" name="date" class="form-control" value="{{ selected_date|default:'' }}">
            <button type="submit" class="btn btn-outline-dark">Filter</button>
        </form>

        <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#addLunchModal">
            <i class="fa-solid fa-plus me-3"></i>Add Lunch Enrollment
        </button>
        <button class="btn btn-dark ms-3" onclick="window.print()">
          <i class="fa-solid fa-print me-3"></i>Print
      </button>
    </div>
    <table class="table table-striped table-hover print-only-table">
        <thead class="table-light">
            <tr>
                <th>#</th>
                <th>Employee Name</th>
                <th>Phone</th>
                <th>Email</th>
                <th>Department</th>
                <th>Enrolled On</th>
            </tr>
        </thead>
        <tbody>
            {% for item in enrollments %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.employee.user.get_full_name }}</td>
                <td>{{ item.employee.phone }}</td>
                <td>{{ item.employee.user.email }}</td>
                <td>{{ item.employee.department.name }}</td>
                <td>{{ item.enrolled_on }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center">No enrolled employees found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>


{% endblock %}