{% extends 'layout.html' %}
{% block body %}
<style>
    /* Ensure thead stays visible when scrolling */
    .sticky-header th {
        position: sticky;
        top: 0;
        z-index: 2;
        background-color: #f8f9fa; /* matches Bootstrap table header color */
    }

    /* Container fluid for smaller screens */
@media (max-width: 1199px) {
  div[style*="width: 1200px"] {
    width: 100% !important;
    padding: 1rem;
    box-sizing: border-box;
  }
}

/* Sidebar stacks above main content and full width */
@media (max-width: 991px) {
  .d-flex {
    flex-direction: column !important;
  }
  .bg-light.text-dark.p-3 {
    width: 100% !important;
    min-height: auto !important;
    margin-bottom: 1.5rem;
    padding: 1rem;
  }
}

/* Search form and add button stack and fill width */
@media (max-width: 575px) {
  .d-flex.mb-3 {
    flex-direction: column !important;
    gap: 10px;
  }
  .d-flex.mb-3 form.d-flex input.form-control,
  .d-flex.mb-3 form.d-flex button.btn,
  .d-flex.mb-3 > button.btn-dark {
    width: 100% !important;
    max-width: 100%;
  }
}

/* Table container constraints and scroll */
@media (max-width: 991px) {
  .table-container {
    max-height: 300px !important;
    overflow-x: auto !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
    border: 1px solid #ddd;
  }

  table.table {
    width: auto !important;
    min-width: 600px;
    font-size: 0.9rem;
    table-layout: auto;
  }

  table.table th,
  table.table td {
    white-space: nowrap;
    padding: 0.3rem 0.5rem !important;
    vertical-align: middle;
  }

  thead.sticky-header {
    position: sticky;
    top: 0;
    background-color: #f8f9fa;
    z-index: 10;
  }
}

/* Further compaction on small phones */
@media (max-width: 575px) {
  .table-container {
    max-height: 250px !important;
  }

  table.table {
    min-width: 450px;
    font-size: 0.85rem !important;
  }

  table.table th,
  table.table td {
    padding: 0.2rem 0.4rem !important;
  }

  .btn,
  .btn-dark {
    font-size: 0.8rem !important;
    padding: 0.25rem 0.5rem !important;
  }
}

/* Sidebar nav wrapping */
.bg-light .nav-link {
  word-break: break-word;
}
.bg-light .nav-link.fw-bold.shadow {
  box-shadow: 0 1px 3px rgba(0,0,0,0.12);
  border-radius: 0.25rem;
}

</style>


<!-- Modal -->
<div class="modal fade" id="addAwardModal" tabindex="-1" aria-labelledby="addAwardModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <form method="POST" action="/employees/benefits/addAwards">
            {% csrf_token %}
            <div class="modal-header">
                <h5 class="modal-title" id="addAwardModalLabel">Add Award</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
        
            <div class="modal-body">
                <div class="row">
                    <!-- Employee Dropdown -->
                    <div class="col-md-6 mb-3">
                        <label>Employee</label>
                        <select name="employee" class="form-control" required>
                            <option value="">Select Employee</option>
                            {% for emp in employees %}
                                <option value="{{ emp.id }}">{{ emp.user.first_name }} {{ emp.user.last_name }} - {{emp.designation.title}}, {{emp.department.name}}</option>
                            {% endfor %}
                        </select>
                    </div>
        
                    <!-- Title -->
                    <div class="col-md-6 mb-3">
                        <label>Award Title</label>
                        <input type="text" name="title" class="form-control" required>
                    </div>
        
                    <!-- Date Awarded -->
                    <div class="col-md-6 mb-3">
                        <label>Date Awarded</label>
                        <input type="date" name="date_awarded" class="form-control" required>
                    </div>
        
                    <!-- Amount -->
                    <div class="col-md-6 mb-3">
                        <label>Award Amount</label>
                        <input type="number" name="amount" step="0.01" class="form-control" required>
                    </div>
        
                    <!-- Description -->
                    <div class="col-md-12 mb-3">
                        <label>Description (optional)</label>
                        <textarea name="description" class="form-control" rows="3"></textarea>
                    </div>
                </div>
            </div>
        
            <div class="modal-footer">
                <button type="submit" class="btn btn-dark">Save Award</button>
            </div>
        </form>
      </div>
    </div>
  </div>


<div class="d-flex" style="margin-top: 80px;">
<div class="bg-light text-dark p-3" style="min-width: 250px; min-height: 100vh;">
        <h5 class="text-center mb-4">Employee Benefits</h5>
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewAwards' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewAwards">üèÜ Awards and Incentives</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'healthInsurance' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/healthInsurance">üíä Health Insurance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewCars' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewCars">üöó Car</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewMobile' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewMobile">üì± Mobile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewAccomodation' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewAccomodation">üè† Accommodation</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewTravelAllowance' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewTravelAllowance">‚úàÔ∏è Travel Allowance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-dark {% if 'viewFoodAndMeals' in request.path %}fw-bold shadow{% endif %}" href="/employees/benefits/viewFoodAndMeals">üç± Food and Meals</a>
          </li>
          
        </ul>
      </div>
    <div style="width: 1200px;">
        <div class="d-flex mb-3">
            <form class="form d-flex me-auto" action="" method="get">
                <!-- Search Input -->
                <input type="text" class="form-control" style="height: 40px; width: 500px;" name="employeeSearch" placeholder="Search employees...">
        
                <!-- Search Button -->
                <button type="submit" class="btn btn-dark ms-2">Search</button>
            </form>
            <button class="btn btn-dark ms-auto" data-bs-toggle="modal" data-bs-target="#addAwardModal"><i class="fa-solid fa-plus me-3"></i>Add Award</button>
        </div>
        

        <div class="table-container" style="max-height: 650px; overflow-y: auto; position: relative;">
            <table class="table table-striped">
                <thead class="sticky-header">
                    <tr>
                        <th>Employee Name</th>
                        <th>Award</th>
                        <th>Award Date</th>
                        <th>Description</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    {% for award in awards %}
                    <tr>
                        <td>{{ award.employee.user.first_name }} {{ award.employee.user.last_name }}</td>
                        <td>{{ award.title }}</td>
                        <td>{{ award.date_awarded }}</td>
                        <td>{{ award.description }}</td>
                        <td>{{ award.amount }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>


{% endblock %}