{% extends 'layout3.html' %}
{% block body %}
<style>
    /* Container fluid width */
@media (max-width: 1199px) {
  .container.mt-4 {
    width: 100% !important;
    padding-left: 1rem !important;
    padding-right: 1rem !important;
    box-sizing: border-box;
  }
}

/* Table container scroll on tablets and below */
@media (max-width: 991px) {
  .table-responsive {
    max-height: 400px !important;
    overflow-x: auto !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
    border: 1px solid #ddd;
    border-radius: 6px;
  }

  table.table {
    min-width: 800px;
    font-size: 0.9rem;
    width: 100%;
    table-layout: auto;
  }

  table.table th,
  table.table td {
    white-space: nowrap;
    padding: 0.3rem 0.6rem;
    vertical-align: middle;
  }

  thead {
    position: sticky;
    top: 0;
    background-color: #f8f9fa;
    z-index: 10;
  }
}

/* Further compact on small phones */
@media (max-width: 575px) {
  .table-responsive {
    max-height: 250px !important;
  }

  table.table {
    min-width: 600px;
    font-size: 0.85rem !important;
  }

  table.table th,
  table.table td {
    padding: 0.2rem 0.4rem !important;
  }
}

/* Make sure the table header remains distinct */
thead tr th {
  border-bottom: 2px solid #dee2e6;
  font-weight: 600;
}

</style>
<div class="container mt-4">
    <h5 class="mb-3">Task History: {{ task.name }} (Project: {{ indivProject.title }})</h5>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Edited By</th>
                    <th>Task Name</th>
                    <th>Assigned To</th>
                    <th>Assign Time</th>
                    <th>Deadline</th>
                    <th>Status</th>
                    <th>Priority</th>
                    <th>Description</th>
                    <th>Progress (%)</th>
                    <th>Edited At</th>
                </tr>
            </thead>
            <tbody>
                {% for history in histories %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ history.edited_by.user.get_full_name }}</td>
                    <td>{{ history.name }}</td>
                    <td>{{ history.assignedTo.user.get_full_name }}</td>
                    <td>{{ history.assignTime|date:"Y-m-d H:i" }}</td>
                    <td>{{ history.deadline|date:"Y-m-d H:i" }}</td>
                    <td>{{ history.status }}</td>
                    <td>{{ history.priority }}</td>
                    <td>{{ history.description }}</td>
                    <td>{{ history.progress }}</td>
                    <td>{{ history.edited_at|date:"Y-m-d H:i" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="11" class="text-center">No history found for this task.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}
