{% load static %}
{% load tagg %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARKS HR Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <link href="{% static 'fontawesomefree/css/fontawesome.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/brands.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/solid.css' %}" rel="stylesheet" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>

<style>
        .nav-item{
            margin-right: 30px;
        }

  /* Ensure thead stays visible when scrolling */
  .sticky-header th {
      position: sticky;
      top: 0;
      z-index: 2;
      background-color: #f8f9fa; /* matches Bootstrap table header color */
  }

  /* Container full width on smaller screens */
@media (max-width: 1199px) {
  .container.mt-5 {
    min-width: unset !important;
    width: 100% !important;
    padding-left: 1rem !important;
    padding-right: 1rem !important;
    box-sizing: border-box;
  }
}

/* Layout stacking and wrapping on mobile */
@media (max-width: 991px) {
  .d-flex {
    flex-direction: column !important;
  }

  /* Sidebar full width */
  .bg-light.text-dark.p-3 {
    width: 100% !important;
    min-height: auto !important;
    margin-bottom: 1.5rem;
    padding: 1rem;
  }

  /* Main content width fluid */
  div[style*="width: 1200px"] {
    width: 100% !important;
    padding: 0 1rem;
    box-sizing: border-box;
    min-width: unset !important;
  }
}

/* Modal width */
@media (max-width: 991px) {
  .modal-lg {
    max-width: 95vw !important;
    margin: 0.5rem auto;
  }
}

/* Buttons and forms responsiveness */
@media (max-width: 575px) {
  /* Navbar toggle styling */
  .navbar-toggler {
    display: flex;
    justify-content: flex-end;
  }

  /* Force sidebar links wrap */
  .bg-light .nav-link {
    word-break: break-word;
  }

  .bg-light .nav-link.fw-bold.shadow {
    box-shadow: 0 1px 3px rgba(0,0,0,0.12);
    border-radius: 0.2em;
  }

  /* Button lengths */
  button.btn,
  .btn {
    width: 100% !important;
    font-size: 0.9rem !important;
    margin-top: 0.3rem;
  }
}

</style>
</head>
<body>
    
    <nav class="navbar navbar-expand-lg bg-body-tertiary shadow fixed-top">
        <div class="container-fluid">
          <a class="navbar-brand d-flex" style="margin-bottom: -10px;" href="/"><h6 class="h5 fw-bold text-info">MARKS</h6><h6 class="h5 fw-bold text-dark ms-2">Automation Ltd.</h6></a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse ms-5" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item dropdown">
                <a class="nav-link {% if 'task' in request.path %}fw-bold{% endif %}" href="/wms/projects/{{indivProject.id}}/tasks">
                  Tasks
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link {% if 'board' in request.path %}fw-bold{% endif %}" href="/wms/projects/{{indivProject.id}}/board">
                  Board
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link {% if 'timeline' in request.path %}fw-bold{% endif %}" href="/wms/projects/{{indivProject.id}}/timeline">
                  Timeline
                </a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link {% if 'calendar' in request.path %}fw-bold{% endif %}" href="/wms/projects/{{indivProject.id}}/calendar">
                  Calendar
                </a>
              </li>
                
            </ul>
            <form class="d-flex" role="search">
              {% if request.user.is_anonymous %}
              <a class="btn btn-dark fw-bold" href="/employees/login">Login</a>
              {% else %}
              <a class="btn btn-dark fw-bold" href="/employees/logout">Logout</a>
              {% endif %}
            </form>
          </div>
        </div>
      </nav>



<div class="d-flex" style="margin-top: 70px;">
    <div class="bg-light text-dark p-3" style="min-width: 250px; min-height: 100vh;">
        <!-- <h5 class="text-center mb-4">Projects</h5> -->
        <button class="btn btn-dark btn-block w-100 mb-4" data-bs-toggle="modal" data-bs-target="#addProjectModal">Add Project</button>
        <ul class="nav flex-column">
          {% for project in projects %}
          <li class="nav-item">
            <a class="nav-link text-dark {% if project.id|to_str in request.path %}fw-bold shadow{% endif %}"
               href="/wms/projects/{{ project.id }}/{{currentTab}}">
               {{ project.title }}
            </a>
          </li>          
          {% endfor %}
        </ul>
      </div>
      
<!-- Add Project Modal -->
<div class="modal fade" id="addProjectModal" tabindex="-1" aria-labelledby="addProjectModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <form method="post" action="/wms/projects/addProject">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="addProjectModalLabel">Add New Project</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Title</label>
              <input type="text" class="form-control" name="title" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Project Leader</label>
              <select class="form-select" name="projectLeader">
                <option value="" selected disabled>Choose Leader</option>
                {% for emp in employees %}
                  <option value="{{ emp.id }}">{{ emp.user.get_full_name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-12">
              <label class="form-label">Description</label>
              <textarea class="form-control" name="description" required></textarea>
            </div>
            <div class="col-md-6">
              <label class="form-label">Start Date</label>
              <input type="date" class="form-control" name="startDate" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">End Date</label>
              <input type="date" class="form-control" name="endDate" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Status</label>
              <select class="form-select" name="status" required>
                <option value="Pending">Pending</option>
                <option value="In Progress">In Progress</option>
                <option value="Completed">Completed</option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary">Create Project</button>
        </div>
      </form>
    </div>
  </div>
</div>

      <div style="width: 1200px;">
        {% block body %}
        {% endblock %}
      </div>


</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>

</body>
</html>













